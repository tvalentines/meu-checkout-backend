<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Magic Germinator - Finalizar Compra</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Exo+2:wght@300;400;600;700&display=swap');
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        :root {
            --primary-green: #00ff41; 
            --secondary-green: #39ff14;
            --dark-green: #0d4d0d;
            --neon-blue: #00ffff;
            --dark-bg: #0a0a0a;
            --glass-bg: rgba(255, 255, 255, 0.05);
            --error-red: #ff3333;
            --success-green: #00ff00;
        }
        body {
            font-family: 'Exo 2', sans-serif;
            background: var(--dark-bg);
            color: #ffffff;
            min-height: 100vh;
            background-image: radial-gradient(circle at 20% 80%, rgba(0, 255, 65, 0.1) 0%, transparent 50%), radial-gradient(circle at 80% 20%, rgba(57, 255, 20, 0.1) 0%, transparent 50%);
        }
        .header {
            background: rgba(10, 10, 10, 0.95);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(0, 255, 65, 0.2);
            padding: 1rem 0;
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        .nav {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 2rem;
        }
        .logo {
            font-family: 'Orbitron', monospace;
            font-size: 1.8rem;
            font-weight: 900;
            background: linear-gradient(45deg, var(--primary-green), var(--neon-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .security-badge {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--primary-green);
            font-size: 0.9rem;
        }
        .checkout-container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
            display: grid;
            grid-template-columns: 1fr 400px;
            gap: 3rem;
            min-height: calc(100vh - 100px);
        }
        .product-section {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(0, 255, 65, 0.2);
            border-radius: 20px;
            padding: 2rem;
            height: fit-content;
        }
        .section-title {
            font-family: 'Orbitron', monospace;
            font-size: 1.8rem;
            color: var(--primary-green);
            margin-bottom: 2rem;
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        .product-card {
            display: flex;
            gap: 2rem;
            padding: 2rem;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            border: 1px solid rgba(0, 255, 65, 0.1);
            margin-bottom: 2rem;
            transition: all 0.3s ease;
        }
        .product-card:hover {
            border-color: var(--primary-green);
            box-shadow: 0 10px 30px rgba(0, 255, 65, 0.2);
        }
        .product-image {
            width: 120px;
            height: 120px;
            background: linear-gradient(45deg, var(--primary-green), var(--neon-blue));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            color: #000;
            font-weight: bold;
        }
        .product-details h3 {
            font-family: 'Orbitron', monospace;
            font-size: 1.5rem;
            color: var(--primary-green);
            margin-bottom: 0.5rem;
        }
        .product-features {
            list-style: none;
            margin: 1rem 0;
        }
        .product-features li {
            padding: 0.3rem 0;
            color: #ccc;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .product-features li::before {
            content: '‚úì';
            color: var(--primary-green);
            font-weight: bold;
        }
        .quantity-control {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin: 1.5rem 0;
        }
        .qty-btn {
            width: 40px;
            height: 40px;
            border: 1px solid var(--primary-green);
            background: transparent;
            color: var(--primary-green);
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s ease;
        }
        .qty-btn:hover {
            background: var(--primary-green);
            color: #000;
            transform: scale(1.1);
        }
        .qty-input {
            width: 60px;
            text-align: center;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(0, 255, 65, 0.3);
            color: white;
            padding: 0.5rem;
            border-radius: 10px;
            font-size: 1.1rem;
        }
        .price-display {
            font-size: 2rem;
            font-weight: 700;
            color: var(--neon-blue);
            text-align: right;
        }
        .checkout-form {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(0, 255, 65, 0.2);
            border-radius: 20px;
            padding: 2rem;
            height: fit-content;
        }
        .form-group {
            margin-bottom: 1.5rem;
        }
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--primary-green);
            font-weight: 600;
        }
        .form-control {
            width: 100%;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.5);
            border: 1px solid rgba(0, 255, 65, 0.3);
            border-radius: 10px;
            color: white;
            font-size: 1rem;
            transition: all 0.3s ease;
        }
        .form-control:focus {
            outline: none;
            border-color: var(--primary-green);
            box-shadow: 0 0 10px rgba(0, 255, 65, 0.3);
        }
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        .shipping-section {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 15px;
            padding: 1.5rem;
            margin: 2rem 0;
            border: 1px solid rgba(0, 255, 65, 0.1);
        }
        .shipping-options {
            display: grid;
            gap: 1rem;
            margin-top: 1rem;
        }
        .shipping-option {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            background: rgba(0, 255, 65, 0.05);
            border: 1px solid rgba(0, 255, 65, 0.2);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .shipping-option:hover {
            border-color: var(--primary-green);
            background: rgba(0, 255, 65, 0.1);
        }
        .shipping-option.selected {
            border-color: var(--primary-green);
            background: rgba(0, 255, 65, 0.15);
        }
        .payment-methods {
            display: grid;
            gap: 1rem;
            margin: 1.5rem 0;
        }
        .payment-method {
            display: flex;
            align-items: center;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(0, 255, 65, 0.2);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .payment-method:hover {
            border-color: var(--primary-green);
            background: rgba(0, 255, 65, 0.1);
        }
        .payment-method.selected {
            border-color: var(--primary-green);
            background: rgba(0, 255, 65, 0.15);
        }
        .payment-icon {
            font-size: 1.5rem;
            margin-right: 1rem;
        }
        .order-summary {
            background: rgba(0, 0, 0, 0.5);
            border-radius: 15px;
            padding: 2rem;
            margin-top: 2rem;
            border: 1px solid rgba(0, 255, 65, 0.2);
        }
        .summary-row {
            display: flex;
            justify-content: space-between;
            padding: 0.8rem 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        .summary-row:last-child {
            border-bottom: none;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--neon-blue);
        }
        .btn {
            padding: 1rem 2rem;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }
        .btn-primary {
            background: linear-gradient(45deg, var(--primary-green), var(--neon-blue));
            color: #000;
            width: 100%;
            font-size: 1.2rem;
            font-weight: 700;
            margin-top: 2rem;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(0, 255, 65, 0.4);
        }
        .error {
            border-color: var(--error-red) !important;
            box-shadow: 0 0 10px rgba(255, 51, 51, 0.3) !important;
        }
        .success {
            border-color: var(--success-green) !important;
            box-shadow: 0 0 10px rgba(0, 255, 0, 0.3) !important;
        }
        .security-info {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: rgba(0, 255, 65, 0.1);
            border-radius: 10px;
            margin-top: 1rem;
            font-size: 0.9rem;
        }
        .security-icon {
            color: var(--primary-green);
            font-size: 1.2rem;
        }
        @media (max-width: 1024px) {
            .checkout-container {
                grid-template-columns: 1fr;
                gap: 2rem;
            }
        }
        @media (max-width: 768px) {
            .checkout-container {
                padding: 1rem;
            }
            .product-card {
                flex-direction: column;
                text-align: center;
            }
            .form-row {
                grid-template-columns: 1fr;
            }
            .quantity-control {
                justify-content: center;
            }
        }
    </style>
</head>
<body>

<header class="header">
    <nav class="nav">
        <div class="logo">MAGIC GERMINATOR</div>
        <div class="security-badge"><span>üîí</span><span>Compra 100% Segura</span></div>
    </nav>
</header>

<div class="checkout-container">

    <!-- Seu Pedido -->
    <div class="product-section">
        <h2 class="section-title"><span>üõí</span> Seu Pedido</h2>
        <div class="product-card">
            <div class="product-image">MG</div>
            <div class="product-details">
                <h3>Magic Germinator Professional</h3>
                <ul class="product-features">
                    <li>Sistema Anti-Ressecamento</li>
                    <li>6 Compartimentos Numerados</li>
                    <li>Capacidade: 60 Sementes</li>
                    <li>Material Premium</li>
                    <li>Garantia Vital√≠cia</li>
                </ul>
                <div class="quantity-control">
                    <button class="qty-btn" onclick="changeQuantity(-1)">-</button>
                    <input type="number" class="qty-input" id="quantity" value="1" min="1" max="10"/>
                    <button class="qty-btn" onclick="changeQuantity(1)">+</button>
                    <span style="margin-left: 1rem; color: #ccc;">Dispon√≠vel: 5 unidades</span>
                </div>
            </div>
            <div class="price-display" id="productPrice">R$ 199,00</div>
        </div>

        <div class="shipping-section">
            <h3 style="color: var(--primary-green); margin-bottom: 1rem;">üì¶ Calcular Frete</h3>
            <div class="form-row">
                <select class="form-control" id="state" onchange="calculateShipping()">
                    <option value="">Selecione seu Estado</option>
                    <option value="AC">Acre</option>
                    <option value="AL">Alagoas</option>
                    <option value="AP">Amap√°</option>
                    <option value="AM">Amazonas</option>
                    <option value="BA">Bahia</option>
                    <option value="CE">Cear√°</option>
                    <option value="DF">Distrito Federal</option>
                    <option value="ES">Esp√≠rito Santo</option>
                    <option value="GO">Goi√°s</option>
                    <option value="MA">Maranh√£o</option>
                    <option value="MT">Mato Grosso</option>
                    <option value="MS">Mato Grosso do Sul</option>
                    <option value="MG">Minas Gerais</option>
                    <option value="PA">Par√°</option>
                    <option value="PB">Para√≠ba</option>
                    <option value="PR">Paran√°</option>
                    <option value="PE">Pernambuco</option>
                    <option value="PI">Piau√≠</option>
                    <option value="RJ">Rio de Janeiro</option>
                    <option value="RN">Rio Grande do Norte</option>
                    <option value="RS">Rio Grande do Sul</option>
                    <option value="RO">Rond√¥nia</option>
                    <option value="RR">Roraima</option>
                    <option value="SC">Santa Catarina</option>
                    <option value="SP">S√£o Paulo</option>
                    <option value="SE">Sergipe</option>
                    <option value="TO">Tocantins</option>
                </select>
                <input type="text" class="form-control" placeholder="CEP (opcional)" id="cep">
            </div>
            <div class="shipping-options" id="shippingOptions"></div>
        </div>
    </div>

    <!-- Formul√°rio de Compra -->
    <div class="checkout-form">
        <h2 class="section-title"><span>üìù</span> Finalizar Compra</h2>
        <form id="checkoutForm">
            <div class="form-group">
                <label for="fullName">Nome Completo *</label>
                <input type="text" class="form-control" id="fullName" required>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="email">Email *</label>
                    <input type="email" class="form-control" id="email" required>
                </div>
                <div class="form-group">
                    <label for="phone">Telefone *</label>
                    <input type="tel" class="form-control" id="phone" required>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="cpf">CPF *</label>
                    <input type="text" class="form-control" id="cpf" placeholder="000.000.000-00" required>
                </div>
                <div class="form-group">
                    <label for="birthDate">Data de Nascimento</label>
                    <input type="date" class="form-control" id="birthDate">
                </div>
            </div>
            <h3 style="color: var(--primary-green); margin: 2rem 0 1rem;">üìç Endere√ßo de Entrega</h3>
            <div class="form-row">
                <div class="form-group">
                    <label for="addressCep">CEP *</label>
                    <input type="text" class="form-control" id="addressCep" placeholder="00000-000" required onblur="searchCEP(this)">
                </div>
                <div class="form-group">
                    <label for="addressState">Estado *</label>
                    <select class="form-control" id="addressState" required>
                        <option value="">Selecione</option>
                        <option value="AC">Acre</option>
                        <option value="AL">Alagoas</option>
                        <option value="AP">Amap√°</option>
                        <option value="AM">Amazonas</option>
                        <option value="BA">Bahia</option>
                        <option value="CE">Cear√°</option>
                        <option value="DF">Distrito Federal</option>
                        <option value="ES">Esp√≠rito Santo</option>
                        <option value="GO">Goi√°s</option>
                        <option value="MA">Maranh√£o</option>
                        <option value="MT">Mato Grosso</option>
                        <option value="MS">Mato Grosso do Sul</option>
                        <option value="MG">Minas Gerais</option>
                        <option value="PA">Par√°</option>
                        <option value="PB">Para√≠ba</option>
                        <option value="PR">Paran√°</option>
                        <option value="PE">Pernambuco</option>
                        <option value="PI">Piau√≠</option>
                        <option value="RJ">Rio de Janeiro</option>
                        <option value="RN">Rio Grande do Norte</option>
                        <option value="RS">Rio Grande do Sul</option>
                        <option value="RO">Rond√¥nia</option>
                        <option value="RR">Roraima</option>
                        <option value="SC">Santa Catarina</option>
                        <option value="SP">S√£o Paulo</option>
                        <option value="SE">Sergipe</option>
                        <option value="TO">Tocantins</option>
                    </select>
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="city">Cidade *</label>
                    <input type="text" class="form-control" id="city" required>
                </div>
                <div class="form-group">
                    <label for="neighborhood">Bairro *</label>
                    <input type="text" class="form-control" id="neighborhood" required>
                </div>
            </div>
            <div class="form-group">
                <label for="street">Endere√ßo *</label>
                <input type="text" class="form-control" id="street" required>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label for="number">N√∫mero *</label>
                    <input type="text" class="form-control" id="number" required>
                </div>
                <div class="form-group">
                    <label for="complement">Complemento</label>
                    <input type="text" class="form-control" id="complement">
                </div>
            </div>
            <h3 style="color: var(--primary-green); margin: 2rem 0 1rem;">üí≥ Forma de Pagamento</h3>
            <div class="payment-methods">
                <label class="payment-method" onclick="selectPayment('pix')">
                    <input type="radio" name="payment" value="pix">
                    <span class="payment-icon">üî≤</span>
                    <div><strong>PIX</strong><br><small style="color: #ccc;">Aprova√ß√£o instant√¢nea</small></div>
                    <span style="color: var(--success-green); font-weight: bold;">5% OFF</span>
                </label>
                <label class="payment-method" onclick="selectPayment('credit')">
                    <input type="radio" name="payment" value="credit">
                    <span class="payment-icon">üí≥</span>
                    <div><strong>Cart√£o de Cr√©dito</strong><br><small style="color: #ccc;">At√© 12x sem juros</small></div>
                </label>
                <label class="payment-method" onclick="selectPayment('boleto')">
                    <input type="radio" name="payment" value="boleto">
                    <span class="payment-icon">üìÑ</span>
                    <div><strong>Boleto Banc√°rio</strong><br><small style="color: #ccc;">Vencimento em 3 dias</small></div>
                    <span style="color: var(--success-green); font-weight: bold;">3% OFF</span>
                </label>
            </div>
            <div class="order-summary">
                <h3 style="color: var(--primary-green); margin-bottom: 1rem;">üìä Resumo do Pedido</h3>
                <div class="summary-row">
                    <span>Magic Germinator (<span id="summaryQty">1</span>x)</span>
                    <span id="summarySubtotal">R$ 199,00</span>
                </div>
                <div class="summary-row">
                    <span>Frete</span>
                    <span id="summaryShipping">A calcular</span>
                </div>
                <div class="summary-row" id="discountRow" style="display: none;">
                    <span style="color: var(--success-green);">Desconto</span>
                    <span id="summaryDiscount" style="color: var(--success-green);">-R$ 0,00</span>
                </div>
                <div class="summary-row">
                    <span><strong>TOTAL</strong></span>
                    <span id="summaryTotal"><strong>R$ 199,00</strong></span>
                </div>
            </div>
            <div class="security-info">
                <span class="security-icon">üõ°Ô∏è</span>
                <div><strong>Compra Protegida</strong><br>Seus dados est√£o seguros com criptografia SSL 256 bits</div>
            </div>
            <button type="submit" class="btn btn-primary" id="submitBtn">FINALIZAR COMPRA</button>
        </form>
    </div>

</div>

<script>
    const productPrice = 199.00;
    let currentQuantity = 1;
    let shippingPrice = 0;
    let discount = 0;
    let selectedPayment = '';
    let selectedShippingType = '';

    // Fun√ß√£o para calcular frete localmente
    function calculateFreightByState(state) {
        const freightTable = {
            'SP': 15.00,
            'RJ': 18.00,
            'MG': 20.00,
            'RS': 22.00,
            'PR': 20.00,
            'SC': 20.00,
            'BA': 25.00,
            'PE': 25.00,
            'CE': 24.00,
            'DF': 22.00,
            'default': 25.00
        };
        return freightTable[state] || freightTable.default;
    }

    async function calculateShipping() {
        const state = document.getElementById('state').value;
        if (!state) {
            alert("Por favor, selecione um estado.");
            return;
        }
        const subtotal = productPrice * currentQuantity;
        shippingPrice = calculateFreightByState(state);
        updatePricing();

        const shippingOptions = document.getElementById('shippingOptions');
        shippingOptions.innerHTML = `
            <label class="shipping-option" onclick="selectShipping('normal', ${shippingPrice})">
                <input type="radio" name="shipping" value="normal">
                <div><strong>üì¶ Frete Padr√£o</strong></div>
                <span style="color: var(--neon-blue); font-weight: bold;">R$ ${shippingPrice.toFixed(2)}</span>
            </label>`;
        shippingOptions.style.display = 'grid';
    }

    function selectShipping(type, price) {
        document.querySelectorAll('.shipping-option').forEach(el => el.classList.remove('selected'));
        event.currentTarget.classList.add('selected');
        shippingPrice = price;
        updatePricing();
    }

    function selectPayment(method) {
        document.querySelectorAll('.payment-method').forEach(el => el.classList.remove('selected'));
        event.currentTarget.classList.add('selected');
        selectedPayment = method;
        calculateDiscount();
        updatePricing();
    }

    function calculateDiscount() {
        const subtotal = productPrice * currentQuantity;
        switch(selectedPayment) {
            case 'pix': discount = subtotal * 0.05; break;
            case 'boleto': discount = subtotal * 0.03; break;
            default: discount = 0;
        }
    }

    function changeQuantity(delta) {
        const qtyInput = document.getElementById('quantity');
        const newQty = Math.max(1, Math.min(10, parseInt(qtyInput.value) + delta));
        qtyInput.value = newQty;
        currentQuantity = newQty;
        updatePricing();
    }

    function updatePricing() {
        const subtotal = productPrice * currentQuantity;
        const total = subtotal + shippingPrice - discount;

        document.getElementById('productPrice').textContent = `R$ ${subtotal.toFixed(2)}`;
        document.getElementById('summaryQty').textContent = currentQuantity;
        document.getElementById('summarySubtotal').textContent = `R$ ${subtotal.toFixed(2)}`;
        document.getElementById('summaryShipping').textContent = shippingPrice > 0 ? `R$ ${shippingPrice.toFixed(2)}` : 'A calcular';

        const discountRow = document.getElementById('discountRow');
        if (discount > 0) {
            discountRow.style.display = 'flex';
            document.getElementById('summaryDiscount').textContent = `-R$ ${discount.toFixed(2)}`;
        } else {
            discountRow.style.display = 'none';
        }
        document.getElementById('summaryTotal').innerHTML = `<strong>R$ ${total.toFixed(2)}</strong>`;
    }

    async function processPayment() {
    const subtotal = productPrice * currentQuantity;
    const total = subtotal + shippingPrice - discount;

    // Garanta que o valor seja um n√∫mero v√°lido
    const amountToSend = parseFloat(total.toFixed(2));
    
    if (isNaN(amountToSend)) {
        alert("Erro: Valor inv√°lido");
        console.error("Valor final:", total);
        return;
    }

    try {
        const response = await fetch('https://meu-checkout-backend-1.onrender.com/api/pix',  {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                amount: amountToSend,
                description: "Magic Germinator",
                reference: `pedido_${Date.now()}`
            })
        });

        if (!response.ok) {
            throw new Error(`Erro HTTP: ${response.status}`);
        }

        const result = await response.json();

        if (!result.success) {
            throw new Error("Dados incompletos da API");
        }

        showPixModal(result);

    } catch (error) {
        alert("Erro ao gerar PIX: " + error.message);
        console.error("Erro completo:", error);
    }
}

    function validateForm() {
        const requiredFields = ['fullName', 'email', 'phone', 'cpf', 'addressCep', 'city', 'neighborhood', 'street', 'number'];
        let isValid = true;
        requiredFields.forEach(fieldId => {
            const field = document.getElementById(fieldId);
            if (!field.value.trim()) {
                field.classList.add('error');
                isValid = false;
            } else {
                field.classList.remove('error');
                field.classList.add('success');
            }
        });

        if (!selectedPayment) {
            alert('Selecione uma forma de pagamento');
            isValid = false;
        }

        if (shippingPrice === 0) {
            alert('Selecione uma op√ß√£o de frete');
            isValid = false;
        }

        return isValid;
    }

    async function searchCEP(input) {
        const cep = input.value.replace(/\D/g, '');
        if (cep.length !== 8) return;
        try {
            const response = await fetch(`https://viacep.com.br/ws/${cep}/json/`); 
            const data = await response.json();
            if (data.erro) throw new Error('CEP n√£o encontrado');
            document.getElementById('street').value = data.logradouro;
            document.getElementById('neighborhood').value = data.bairro;
            document.getElementById('city').value = data.localidade;
            document.getElementById('addressState').value = data.uf;
            document.getElementById('state').value = data.uf;
            document.getElementById('complement').value = data.complemento;
        } catch (e) {
            alert("Erro ao buscar o CEP.");
        }
    }

    document.getElementById('checkoutForm').addEventListener('submit', async function(e) {
        e.preventDefault();
        if (!validateForm()) return;

        const submitBtn = document.getElementById('submitBtn');
        submitBtn.textContent = 'Processando...';
        submitBtn.disabled = true;

        await processPayment();

        submitBtn.textContent = 'FINALIZAR COMPRA';
        submitBtn.disabled = false;
    });

    function showPixModal(response) {
        const modal = document.createElement('div');
        modal.style.cssText = `
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); z-index: 10000; display: flex;
            align-items: center; justify-content: center;
        `;
        modal.innerHTML = `
            <div style="background: var(--dark-bg); border: 1px solid var(--primary-green); 
                       border-radius: 20px; padding: 2rem; max-width: 500px; text-align: center;">
                <h2 style="color: var(--primary-green); margin-bottom: 1rem;">üî≤ PIX</h2>
                <p style="color: #ccc; margin: 1rem 0;">Valor: R$ ${response.total?.toFixed(2) || '---'}</p>
                <div style="width: 200px; height: 200px; background: white; margin: 0 auto;"></div>
                <textarea rows="4" readonly style="width: 100%; margin-top: 1rem; padding: 1rem; font-size: 0.9rem;" onclick="this.select(); document.execCommand('copy'); alert('Copiado!')">
${response.copy_paste || 'N√£o dispon√≠vel'}
                </textarea>
                <button onclick="this.parentElement.parentElement.remove()" 
                        style="margin-top: 1rem; background: var(--primary-green); color: #000; border: none; 
                               padding: 1rem 2rem; border-radius: 10px; cursor: pointer;">
                    Fechar
                </button>
            </div>
        `;
        document.body.appendChild(modal);
    }

    document.addEventListener('DOMContentLoaded', () => {
        updatePricing();
    });
</script>

</body>
</html>